!function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},t.apply(null,arguments)}!function(){function n(e){return"classNames"in e}function r(e){return"attrs"in e}function i(e,t){for(var n=1,r=!1,i=null,s=t;s<e.length;s++){var o=e[s],a='"'===o||"'"===o;if(!a||r){if(a&&r&&o===i)r=!1,i=null;else if(!r)if("("===o)n++;else if(")"===o&&0===--n)return s}else r=!0,i=o}return-1}function s(e,t){for(var n=[],r="",i=0,s=!1,o=null,a=new Set(t),u=0;u<e.length;u++){var c=e[u],l='"'===c||"'"===c;!l||s?l&&s&&c===o?(s=!1,o=null,r+=c):s||("("===c?i++:")"===c&&i>0&&i--,0!==i||!a.has(c))?r+=c:(r.trim()&&n.push(r.trim()),r=""):(s=!0,o=c,r+=c)}return r.trim()&&n.push(r.trim()),n}function o(e){var t=e.slice(1,-1).trim(),n={};return t?(s(t,[" "]).forEach(function(e){var t=e.split(":"),r=t[0],i=t[1];if(r)if("delay"!==r)if("debounce"!==r)n[r]=null==i||i;else{var s=Number(i);Number.isNaN(s)||(n.debounce=s)}else{var o=Number(i);Number.isNaN(o)||(n.delay=o)}}),n):n}function a(e,t){if("this"===t)return[e];try{if(t.startsWith(">"))return Array.from(e.querySelectorAll(":scope"+t));if(t.startsWith("+")){var n=e.nextElementSibling;return n&&n.matches(t.slice(1))?[n]:[]}if(t.startsWith("~")){for(var r=[],i=e.nextElementSibling,s=t.slice(1);i;)i.matches(s)&&r.push(i),i=i.nextElementSibling;return r}return Array.from(document.querySelectorAll(t))}catch(e){return console.warn("Swiss: bad selector:",t),[]}}function u(e){e.forEach(function(e){"className"in e?e.hasClass?e.el.classList.add(e.className):e.el.classList.remove(e.className):null===e.value?e.el.removeAttribute(e.attr):e.el.setAttribute(e.attr,e.value)})}function c(e,t){switch(t.type){case"toggle":case"add":case"remove":return void a(e,t.selector).forEach(function(e){var i,s;n(t)&&(i=e,s=t.type,t.classNames.forEach(function(e){"toggle"===s?i.classList.toggle(e):"add"===s?i.classList.add(e):i.classList.remove(e)})),r(t)&&function(e,t,n){for(var r in n){var i=n[r];if("remove"!==t)if("toggle"!==t)"add"===t&&e.setAttribute(r,null===i?"":i);else{if(i&&i.includes("|")){var s=i.split("|"),o=s[0],a=s[1],u=e.getAttribute(r);e.setAttribute(r,u===o?a:o);continue}if(null===i){e.hasAttribute(r)?e.removeAttribute(r):e.setAttribute(r,"");continue}e.getAttribute(r)===i?e.removeAttribute(r):e.setAttribute(r,i)}else e.removeAttribute(r)}}(e,t.type,t.attrs)});case"run":try{new Function(t.js)()}catch(e){console.error("Swiss run error:",e)}return;case"event":return void t.eventNames.forEach(function(t){e.dispatchEvent(new CustomEvent(t,{bubbles:!0}))})}}var l=new WeakMap;function f(e,t,n){t.forEach(function(t){var r,i,s,o=void 0===(null==(r=t.options)?void 0:r.debounce)||t.options.debounce>0,a="number"==typeof(null==(i=t.options)?void 0:i.delay)?t.options.delay:0,u="number"==typeof(null==(s=t.options)?void 0:s.debounce)?t.options.debounce:100,l=function(){a>0?setTimeout(function(){return c(e,t)},a):c(e,t)};if(o){var f=n.timers.get(t);f&&clearTimeout(f);var d=window.setTimeout(l,u);n.timers.set(t,d)}else l()})}function d(d){var v=d,m=function(e){var n=e.getAttribute("data-swiss")||"",r=function(e){return e?s(e,[" ",";"]).map(function(e){if(e.startsWith("run("))return function(e){if(!e.startsWith("run("))return null;var t=i(e,4);if(-1===t)return console.warn("Swiss: unbalanced parentheses in run()",e),null;var n,r=e.slice(4,t),s=e.slice(t+1).trim();return s&&(s.startsWith("(")&&s.endsWith(")")?n=o(s):console.warn("Swiss: invalid options block in run()",e)),{type:"run",js:r,options:n}}(e);if(e.startsWith("event("))return function(e){if(!e.startsWith("event("))return null;if(!e.endsWith(")")&&!e.includes(")("))return console.warn("Swiss: invalid event() syntax:",e),null;var t=i(e,6);if(-1===t)return console.warn("Swiss: unbalanced parentheses in event()",e),null;var n=e.slice(6,t).trim();if(!n)return console.warn("Swiss: empty event() payload:",e),null;var r,a=s(n,[" "]),u=e.slice(t+1).trim();return u&&(u.startsWith("(")&&u.endsWith(")")?r=o(u):console.warn("Swiss: invalid options block in event()",e)),{type:"event",eventNames:a,options:r}}(e);var n=e.match(/^(\w+)(?:\[(.+?)\])?\((.+?)\)(?:\((.+?)\))?$/);if(!n)return console.warn("Swiss: invalid action format:",e),null;var r=n[1],a=n[2],u=n[3],c=n[4];if(!["toggle","add","remove"].includes(r))return console.warn("Swiss: unsupported action type:",r),null;var l=a?a.trim():"this",f=u.trim(),d=[],v={};s(f,[" "]).forEach(function(e){e.startsWith("{")&&e.endsWith("}")?v=t({},v,function(e){var t=e.slice(1,-1).trim(),n={};return t?(s(t,[" "]).forEach(function(e){if(e.includes(":")){var t=e.split(":");n[t[0]]=t[1]}else n[e]=null}),n):n}(e)):d.push(e)});var m=c?o("("+c+")"):void 0,h=d.length>0,p=Object.keys(v).length>0;return h&&p?{type:r,selector:l,classNames:d,attrs:v,options:m}:p?{type:r,selector:l,attrs:v,options:m}:{type:r,selector:l,classNames:d,options:m}}).filter(function(e){return Boolean(e)}):[]}(n),a=r.length>0;return{raw:n,actions:r,hasActions:a,events:function(e){var t=[];return e.forEach(function(e){"hover"===e?t.push("mouseenter","mouseleave"):t.push(e)}),t}(a&&e.hasAttribute("data-swiss-on")?e.getAttribute("data-swiss-on").split(/\s+/).filter(Boolean):a?["click"]:[]),stopProp:e.hasAttribute("data-swiss-stop-propagation"),ifElSelector:e.getAttribute("data-swiss-if"),whenMedia:e.getAttribute("data-swiss-when"),resetOnResize:e.hasAttribute("data-swiss-reset-on-resize"),resetWhenDisabled:e.hasAttribute("data-swiss-reset-when-disabled")}}(v),h=m.actions,p=m.hasActions,b=m.events,w=m.stopProp,g=m.ifElSelector,y=m.whenMedia,A=m.resetOnResize,E=m.resetWhenDisabled,S=null,N=!1;function L(){if(!g)return!0;var e=document.querySelector(g);return!(!e||!e.matches(g))}function W(){L()&&h.forEach(function(e){return n=function(e){return c(v,e)},void((i=null==(r=(t=e).options)?void 0:r.delay)&&i>0?setTimeout(function(){return n(t)},i):n(t));var t,n,r,i})}function O(e){if(L()){var t=e.target;if(t&&!v.contains(t)){var n=v.getAttribute("data-swiss-on-click-outside-ignore");if(n){var r=Array.from(document.querySelectorAll(n)).some(function(e){return e.contains(t)});if(r)return}W()}}}function k(){!y||window.matchMedia(y).matches?N||(N=!0,w&&v.addEventListener("click",function(e){e.target===v&&e.stopPropagation()}),p&&(S=function(t,i){var s=[];return i.forEach(function(i){"selector"in i&&a(t,i.selector).forEach(function(t){if(r(i))for(var o in i.attrs){var a=t.getAttribute(o);s.push({el:t,attr:o,value:a})}if(n(i))for(var u,c=function(t){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t))){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(i.classNames);!(u=c()).done;){var l=u.value;s.push({el:t,className:l,hasClass:t.classList.contains(l)})}})}),s}(v,h),b.forEach(function(e){"clickOutside"===e?(document.addEventListener("mousedown",O),document.addEventListener("touchstart",O)):["enter","exit"].includes(e)||v.addEventListener(e,W)}))):N&&(N=!1,p&&(b.forEach(function(e){"clickOutside"===e?(document.removeEventListener("mousedown",O),document.removeEventListener("touchstart",O)):["enter","exit"].includes(e)||v.removeEventListener(e,W)}),E&&S&&u(S)))}if(b.includes("enter")||b.includes("exit")){var x=new IntersectionObserver(function(e){e.forEach(function(e){e.target===v&&function(e,t,n,r){if(t.includes("enter")||t.includes("exit")){var i=l.get(e);i||(i={entered:!1,timers:new Map},l.set(e,i));var s=r.isIntersecting;if(s){if(i.entered)return;i.entered=!0,t.includes("enter")&&f(e,n,i)}!s&&i.entered&&(i.entered=!1,t.includes("exit")&&f(e,n,i))}}(v,b,h,e)})},{threshold:0});x.observe(v)}(p||w)&&(k(),y&&window.addEventListener("resize",k),A&&window.addEventListener("resize",function(){S&&u(S)}))}function v(){document.querySelectorAll("[data-swiss], [data-swiss-stop-propagation], [data-swiss-on='clickOutside']").forEach(d)}"loading"!==document.readyState?v():document.addEventListener("DOMContentLoaded",v)}()});
//# sourceMappingURL=swiss.umd.js.map
